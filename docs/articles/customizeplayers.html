<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Customizing Players - Advanced • dfsOptimizer</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Customizing Players - Advanced">
<meta property="og:description" content="dfsOptimizer">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dfsOptimizer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basicusage.html">Basic Usage</a>
    </li>
    <li>
      <a href="../articles/customizeplayers.html">Customizing Players - Advanced</a>
    </li>
    <li>
      <a href="../articles/rules.html">Customizing your Optimizer</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="customizeplayers_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Customizing Players - Advanced</h1>
            
      
      
      <div class="hidden name"><code>customizeplayers.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">dfsOptimizer</span><span class="op">)</span></code></pre></div>
<div id="basic-methods" class="section level1">
<h1 class="hasAnchor">
<a href="#basic-methods" class="anchor"></a>Basic Methods</h1>
<p>The package includes a lot of methods for customizing individual players in your model (see the “Customizing your Optimizer” vignette for examples)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Example of how to block players by ID</span>
<span class="co"># Single Player</span>
<span class="va">opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/block_players_by_id,optimizer-method.html">block_players_by_id</a></span><span class="op">(</span><span class="va">opt</span>, player_ids <span class="op">=</span> <span class="va">single_player_id</span><span class="op">)</span>

<span class="co"># Blocking multiple players uses the same syntax</span>
<span class="va">opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/block_players_by_id,optimizer-method.html">block_players_by_id</a></span><span class="op">(</span><span class="va">opt</span>, player_ids <span class="op">=</span> <span class="va">multiple_player_ids</span><span class="op">)</span></code></pre></div>
</div>
<div id="customizing-player-sets---advanced" class="section level1">
<h1 class="hasAnchor">
<a href="#customizing-player-sets---advanced" class="anchor"></a>Customizing Player Sets - Advanced</h1>
<p>Let’s say you want to do something complicated, like * Remove every player who <em>either</em> is in the bottom 50% of projected value (fpts/salary) OR plays for Montreal * Lock the two wingers with the highest points * Set the maximum exposure of all players to be proportional to their projected value, <em>within teams</em></p>
<p>You could use the various sets of functions included in this package, But for complex, multi-step customization, the flow I recommend is: 1. Add players to an optimizer object 2. Pull those players out using <code><a href="../reference/get_player_data,optimizer-method.html">get_player_data()</a></code> 3. Use whatever R code you like on the data.table of players 4. Put the table back into the model with <code>add_players_from_df</code></p>
<p>Here’s how we’d handle the above example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Instantiate</span>
<span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_optimizer.html">create_optimizer</a></span><span class="op">(</span>site <span class="op">=</span> <span class="st">'DRAFTKINGS'</span>, sport <span class="op">=</span> <span class="st">'HOCKEY'</span>, contest_type <span class="op">=</span> <span class="st">'CLASSIC'</span><span class="op">)</span>

<span class="co"># Add players (using the data set nhl_players, which is included in the package)</span>
<span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_players_from_df,optimizer-method.html">add_players_from_df</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">nhl_players</span><span class="op">)</span>
<span class="va">mod</span></code></pre></div>
<pre><code>#&gt; Optimizer Object (S4 class)
#&gt; Site: DRAFTKINGS
#&gt; Sport: HOCKEY
#&gt; Contest Type: CLASSIC
#&gt; Number of Players: 308</code></pre>
<p>One can see we have 308 players in our set – Let’s pull the out into a data.table</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Pull those right back out</span>
<span class="co"># This step is necessary if you added players to your model via CSV,</span>
<span class="co"># otherwise you could just manipulate the original data.frame before</span>
<span class="co"># adding it to the model</span>
<span class="va">players</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_player_data,optimizer-method.html">get_player_data</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">players</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt;          id first_name  last_name           fullname team position depth salary
#&gt; 1: 14086443     Nathan  MacKinnon   Nathan MacKinnon  COL        C     1   8300
#&gt; 2: 14087003   Frederik   Andersen  Frederik Andersen  TOR        G     1   8200
#&gt; 3: 14087005    Michael Hutchinson Michael Hutchinson  TOR        G     1   8000
#&gt; 4: 14087004      Carey      Price        Carey Price  MON        G     1   8000
#&gt; 5: 14086445     Auston   Matthews    Auston Matthews  TOR        C     1   7900
#&gt; 6: 14087007    Charlie   Lindgren   Charlie Lindgren  MON        G     1   7800
#&gt;     fpts locked blocked is_injured min_exposure max_exposure variance
#&gt; 1: 19.00  FALSE   FALSE      FALSE           NA           NA       NA
#&gt; 2: 15.78  FALSE   FALSE      FALSE           NA           NA       NA
#&gt; 3: 11.26  FALSE   FALSE      FALSE           NA           NA       NA
#&gt; 4: 12.18  FALSE   FALSE      FALSE           NA           NA       NA
#&gt; 5: 15.85  FALSE   FALSE      FALSE           NA           NA       NA
#&gt; 6: 16.10  FALSE   FALSE      FALSE           NA           NA       NA</code></pre>
<p>Now that we have the players, we can manipulate the table however we want – I’m going to use data.table in this example, but you could just as easily use whatever methods or packages you want.</p>
<p>Remember what we want to do: * Remove every player who <em>either</em> is in the bottom 50% of projected value (fpts/salary) OR plays for Montreal * Lock the two wingers with the highest points * Set the maximum exposure of all players to be proportional to their projected value, <em>within teams</em></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Remove every player who _either_ is in the bottom 50% of projected value (fpts/salary) OR plays for Montreal</span>
<span class="va">players</span> <span class="op">&lt;-</span>
  <span class="va">players</span><span class="op">[</span><span class="va">fpts</span><span class="op">/</span><span class="va">salary</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">fpts</span><span class="op">/</span><span class="va">salary</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="va">team</span> <span class="op">!=</span> <span class="st">'MON'</span><span class="op">]</span>

<span class="co"># Lock the two wingers with the highest points</span>
<span class="va">players</span><span class="op">[</span> <span class="va">id</span> <span class="op">%in%</span> <span class="va">players</span><span class="op">[</span><span class="va">position</span> <span class="op">==</span> <span class="st">'W'</span>, <span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="op">-</span><span class="va">fpts</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">id</span><span class="op">]</span>, <span class="va">locked</span> <span class="op">:=</span> <span class="cn">TRUE</span><span class="op">]</span>

<span class="co"># Set the maximum exposure of all players to be proportional to their projected value, *within teams*</span>
<span class="va">players</span><span class="op">[</span>, <span class="va">max_exposure</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">fpts</span><span class="op">/</span><span class="va">salary</span>, ties.method <span class="op">=</span> <span class="st">'first'</span><span class="op">)</span> <span class="op">/</span> <span class="va">.N</span>, by <span class="op">=</span> <span class="va">team</span><span class="op">]</span></code></pre></div>
<p>From here, you just put the data right back in using <code>add_players_from_df</code></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_players_from_df,optimizer-method.html">add_players_from_df</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">players</span><span class="op">)</span>
<span class="va">mod</span></code></pre></div>
<pre><code>#&gt; Optimizer Object (S4 class)
#&gt; Site: DRAFTKINGS
#&gt; Sport: HOCKEY
#&gt; Contest Type: CLASSIC
#&gt; Number of Players: 132</code></pre>
<p>You could, of course, use this method in conjunction with external data as well. For instance, if you wanted to remove anyone who played the night before, or who hasn’t player more than N games, you could join in an external set with values like “Days since played” or “N Games Played” and use that to filter the data down before setting it back into the model!</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Anthony Shook.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
